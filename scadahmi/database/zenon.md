[<- До підрозділу](README.md)

# Доступ до БД зі SCADA zenon

Для роботи із зовнішніми базами даних для записування та читання в довільному форматі у SCADA zenon необхідно скористатися скриптами у VBA або VSTA з підключенням відповідних бібліотек. 

Наприклад, для записування значень у таблицю, що означена в прикладі з параграфа 8.3.3 через інтерфейс ADO необхідно у VBA підключити бібліотеку ADODB (рис. 1) 

<a href="media8/8_19.png" target="_blank"><img src="media/8_19.png"/></a> 

*Рис. 1.* Підключення до VBA бібліотеки ADODB

На рис. 2 показано приклад функції FnWriteToSQL, яка заносить новий запис через об’єкт Recordset та полями Name, Water, Sugar, Flour, Salt, Yeast, Milk. 

<a href="media8/8_20.png" target="_blank"><img src="media/8_20.png"/></a> 

*Рис. 2.* Лістинг програми добавлення нових записів рецепту у VBA

Для роботи з БД з VBA можна використовувати й інші бібліотеки, що підтримують інтерфейси OLEAutomation та ActiveX. SCADA zenon має можливість працювати з ODBC через драйвер SQLDRV. Однак цей драйвер дає можливість зчитувати та записувати значення змінних у наперед сконфігуровані у відповідному форматі таблиці RECEIVE та SEND. Цей драйвер можна використовувати як інтеграційну ланку з іншими застосунками. 

Теоретичне заняття розробив [Олександр Пупена](https://github.com/pupenasan). 